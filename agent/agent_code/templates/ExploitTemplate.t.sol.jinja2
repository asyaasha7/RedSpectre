
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/{{ target_contract_name }}.sol";

contract AutoExploitTest_{{ vulnerability_id }} is Test {
    {{ target_contract_name }} public target;

    function setUp() public {
        target = new {{ target_contract_name }}();
        vm.deal(address(this), 100 ether);
    }

    function testExploit_{{ vulnerability_id }}() public {
        address beforeOwner = target.owner();
        uint256 beforeBalance = address(target).balance;

        console.log("[-] Before: owner=%s bal=%s", beforeOwner, beforeBalance);

        {{ step_1_code }}
        {{ step_2_code }}

        address afterOwner = target.owner();
        uint256 afterBalance = address(target).balance;

        console.log("[+] After: owner=%s bal=%s", afterOwner, afterBalance);

        {{ invariant_check }}
    }
}
